# è°ƒè¯•æŒ‡å— - å¦‚ä½•æŸ¥çœ‹æ§åˆ¶å°

## ğŸ“º æ§åˆ¶å°ä½ç½®

### 1ï¸âƒ£ å‰ç«¯æ§åˆ¶å°ï¼ˆæ¨èï¼‰

åœ¨è¿è¡Œçš„ **MD.AI åº”ç”¨çª—å£**ä¸­æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼š

**macOS**:
```bash
âŒ˜ + âŒ¥ + I  æˆ–  âŒ˜ + âŒ¥ + J
```

**Windows/Linux**:
```bash
Ctrl + Shift + I  æˆ–  F12
```

**æ˜¾ç¤ºå†…å®¹**ï¼š
- âœ… JavaScript é”™è¯¯å’Œè­¦å‘Š
- âœ… `console.log` è¾“å‡º
- âœ… ç½‘ç»œè¯·æ±‚
- âœ… Tauri æ’ä»¶è°ƒç”¨ï¼ˆdialogã€fsï¼‰
- âœ… æ–‡ä»¶æ“ä½œæ—¥å¿—

**ç¤ºä¾‹æ—¥å¿—**ï¼š
```
[file.ts] Opening file dialog in Tauri...
[file.ts] Selected file: /Users/cgy/Documents/test.md
[file.ts] File read successfully, length: 1234
```

---

### 2ï¸âƒ£ ç»ˆç«¯æ§åˆ¶å°

åœ¨è¿è¡Œ `npm run tauri dev` çš„ç»ˆç«¯çª—å£ä¸­æŸ¥çœ‹ï¼š

**ä½ç½®**ï¼š
- Cursor IDE åº•éƒ¨çš„ç»ˆç«¯é¢æ¿
- æˆ–ç‹¬ç«‹ç»ˆç«¯çª—å£

**æ˜¾ç¤ºå†…å®¹**ï¼š
- âœ… Vite ç¼–è¯‘æ—¥å¿—
- âœ… Rust åç«¯æ—¥å¿—
- âœ… æ„å»ºé”™è¯¯
- âœ… ç³»ç»Ÿçº§é”™è¯¯

**æŸ¥çœ‹æ–¹å¼**ï¼š
```bash
# å½“å‰ç»ˆç«¯æ—¥å¿—æ–‡ä»¶
cat ~/.cursor/projects/Users-cgy-wkgit-md-ai/terminals/10.txt
```

---

## ğŸ› å¸¸è§é”™è¯¯æ’æŸ¥

### é”™è¯¯ 1: æ–‡ä»¶å¯¹è¯æ¡†ä¸å¼¹å‡º

**ç—‡çŠ¶**ï¼šç‚¹å‡»"æ‰“å¼€"æˆ–"ä¿å­˜"æŒ‰é’®ï¼Œæ²¡æœ‰ååº”

**æ’æŸ¥æ­¥éª¤**ï¼š

1. **æ‰“å¼€å‰ç«¯æ§åˆ¶å°** (`âŒ˜âŒ¥I`)
2. **ç‚¹å‡»"æ‰“å¼€æ–‡ä»¶"æŒ‰é’®**
3. **æŸ¥çœ‹æ§åˆ¶å°é”™è¯¯ä¿¡æ¯**

**å¯èƒ½çš„é”™è¯¯å’Œè§£å†³æ–¹æ¡ˆ**ï¼š

#### é”™è¯¯ A: æƒé™è¢«æ‹’ç»
```
Error: Permission denied: dialog:allow-open
```

**è§£å†³æ–¹æ¡ˆ**ï¼šæ£€æŸ¥ `src-tauri/capabilities/default.json`
```json
"permissions": [
  "dialog:allow-open",
  "dialog:allow-save",
  "fs:allow-read-text-file",
  "fs:allow-write-text-file"
]
```

#### é”™è¯¯ B: Tauri æ’ä»¶æœªåŠ è½½
```
Error: Cannot find module '@tauri-apps/plugin-dialog'
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# é‡æ–°å®‰è£…ä¾èµ–
npm install
cd src-tauri && cargo clean && cd ..
npm run tauri dev
```

#### é”™è¯¯ C: å‡½æ•°æœªå®šä¹‰
```
TypeError: openFile is not a function
```

**è§£å†³æ–¹æ¡ˆ**ï¼šæ£€æŸ¥å¯¼å…¥æ˜¯å¦æ­£ç¡®
```typescript
import { openFile, saveFile, saveFileAs } from './lib/file';
```

---

### é”™è¯¯ 2: æ–‡ä»¶å†…å®¹ä¹±ç 

**ç—‡çŠ¶**ï¼šæ‰“å¼€æ–‡ä»¶åæ˜¾ç¤ºä¹±ç 

**æ’æŸ¥æ­¥éª¤**ï¼š
1. æ£€æŸ¥æ§åˆ¶å°æ˜¯å¦æœ‰ç¼–ç é”™è¯¯
2. ç¡®è®¤æ–‡ä»¶æ˜¯ UTF-8 ç¼–ç 

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# æ£€æŸ¥æ–‡ä»¶ç¼–ç 
file -I your-file.md

# è½¬æ¢ä¸º UTF-8
iconv -f GBK -t UTF-8 your-file.md > new-file.md
```

---

### é”™è¯¯ 3: å¯¼å‡ºåŠŸèƒ½å¤±è´¥

**ç—‡çŠ¶**ï¼šå¯¼å‡º HTML/PDF/PNG å¤±è´¥

**æ’æŸ¥æ­¥éª¤**ï¼š
1. æ‰“å¼€å‰ç«¯æ§åˆ¶å°
2. ç‚¹å‡»å¯¼å‡ºæŒ‰é’®
3. æŸ¥çœ‹é”™è¯¯ä¿¡æ¯

**å¯èƒ½çš„é”™è¯¯**ï¼š

#### é”™è¯¯ A: html2canvas åŠ è½½å¤±è´¥
```
Error loading html2canvas
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
npm install html2canvas
```

#### é”™è¯¯ B: å†™å…¥æƒé™è¢«æ‹’ç»
```
Error: Permission denied: fs:allow-write-file
```

**è§£å†³æ–¹æ¡ˆ**ï¼šæ·»åŠ æƒé™åˆ° `capabilities/default.json`

---

## ğŸ§ª æµ‹è¯•æ­¥éª¤

### æµ‹è¯• 1: æ‰“å¼€æ–‡ä»¶

1. **æ‰“å¼€æ§åˆ¶å°** (`âŒ˜âŒ¥I`)
2. **ç‚¹å‡» "æ–‡ä»¶" â†’ "æ‰“å¼€"** æˆ–æŒ‰ `âŒ˜O`
3. **è§‚å¯Ÿæ§åˆ¶å°è¾“å‡º**ï¼š

**æ­£å¸¸è¾“å‡º**ï¼š
```
[file.ts] Opening file dialog in Tauri...
[file.ts] Selected file: /Users/xxx/test.md
[file.ts] File read successfully, length: 1234
```

**å¦‚æœæœ‰é”™è¯¯**ï¼š
- å¤åˆ¶å®Œæ•´çš„é”™è¯¯ä¿¡æ¯
- æ£€æŸ¥æƒé™é…ç½®
- æŸ¥çœ‹æœ¬æ–‡æ¡£çš„"å¸¸è§é”™è¯¯æ’æŸ¥"

---

### æµ‹è¯• 2: ä¿å­˜æ–‡ä»¶

1. **åœ¨ç¼–è¾‘å™¨ä¸­è¾“å…¥å†…å®¹**
2. **æ‰“å¼€æ§åˆ¶å°** (`âŒ˜âŒ¥I`)
3. **æŒ‰ `âŒ˜S` ä¿å­˜**
4. **è§‚å¯Ÿæ§åˆ¶å°è¾“å‡º**ï¼š

**æ­£å¸¸è¾“å‡º**ï¼š
```
[file.ts] Saving file, currentPath: undefined
[file.ts] Saving to: /Users/xxx/new-file.md
[file.ts] File saved successfully
```

---

### æµ‹è¯• 3: å¯¼å‡º HTML

1. **æ‰“å¼€æ§åˆ¶å°** (`âŒ˜âŒ¥I`)
2. **ç‚¹å‡» "æ–‡ä»¶" â†’ "å¯¼å‡º" â†’ "HTML"**
3. **è§‚å¯Ÿæ§åˆ¶å°è¾“å‡º**ï¼š

**æ­£å¸¸è¾“å‡º**ï¼š
```
Exporting HTML...
HTML exported successfully
```

---

## ğŸ” å®æ—¶è°ƒè¯•

### å¯ç”¨è¯¦ç»†æ—¥å¿—

åœ¨ `src/lib/file.ts` ä¸­ï¼Œæ‰€æœ‰å…³é”®æ“ä½œéƒ½æœ‰ `console.log`ï¼š

```typescript:7:42:src/lib/file.ts
export function isTauri(): boolean {
  return typeof window !== 'undefined' && '__TAURI__' in window;
}

/**
 * æ‰“å¼€æ–‡ä»¶å¯¹è¯æ¡†å¹¶è¯»å– Markdown æ–‡ä»¶
 */
export async function openFile(): Promise<{ content: string; path: string } | null> {
  if (isTauri()) {
    // Tauri ç¯å¢ƒ
    try {
      console.log('[file.ts] Opening file dialog in Tauri...');
      const { open } = await import('@tauri-apps/plugin-dialog');
      const { readTextFile } = await import('@tauri-apps/plugin-fs');
      
      const filePath = await open({
        multiple: false,
        filters: [{
          name: 'Markdown',
          extensions: ['md', 'markdown', 'txt']
        }]
      });
      
      console.log('[file.ts] Selected file:', filePath);
      
      if (filePath && typeof filePath === 'string') {
        const content = await readTextFile(filePath);
        console.log('[file.ts] File read successfully, length:', content.length);
        return { content, path: filePath };
      }
      return null;
    } catch (error) {
      console.error('[file.ts] Error opening file:', error);
```

---

## ğŸ“± å¿«é€Ÿæ£€æŸ¥æ¸…å•

æµ‹è¯•ä»»ä½•åŠŸèƒ½å‰ï¼Œå…ˆæ‰§è¡Œï¼š

- [ ] âœ… åº”ç”¨æ­£åœ¨è¿è¡Œï¼ˆç»ˆç«¯æ˜¾ç¤º `Running target/debug/md-ai`ï¼‰
- [ ] âœ… å‰ç«¯æ§åˆ¶å°å·²æ‰“å¼€ (`âŒ˜âŒ¥I`)
- [ ] âœ… æ§åˆ¶å° Console æ ‡ç­¾é¡µå·²é€‰ä¸­
- [ ] âœ… æ§åˆ¶å°æ²¡æœ‰è¿‡æ»¤å™¨ï¼ˆæ˜¾ç¤ºæ‰€æœ‰æ—¥å¿—ï¼‰

**ç„¶åå¼€å§‹æµ‹è¯•åŠŸèƒ½**ï¼š
- [ ] æ–‡ä»¶æ‰“å¼€ (`âŒ˜O`)
- [ ] æ–‡ä»¶ä¿å­˜ (`âŒ˜S`)
- [ ] å¦å­˜ä¸º (`â‡§âŒ˜S`)
- [ ] å¯¼å‡º HTML
- [ ] å¯¼å‡º PDF
- [ ] å¯¼å‡º PNG

**é‡åˆ°é—®é¢˜æ—¶**ï¼š
1. ğŸ“¸ æˆªå›¾æ§åˆ¶å°é”™è¯¯ä¿¡æ¯
2. ğŸ“‹ å¤åˆ¶å®Œæ•´é”™è¯¯å †æ ˆ
3. ğŸ” å‚è€ƒæœ¬æ–‡æ¡£çš„"å¸¸è§é”™è¯¯æ’æŸ¥"

---

## ğŸ“ è·å–å¸®åŠ©

å¦‚æœä»¥ä¸Šæ­¥éª¤æ— æ³•è§£å†³é—®é¢˜ï¼Œè¯·æä¾›ï¼š
1. æ§åˆ¶å°å®Œæ•´é”™è¯¯ä¿¡æ¯ï¼ˆæˆªå›¾æˆ–æ–‡æœ¬ï¼‰
2. ç»ˆç«¯è¾“å‡ºï¼ˆå¦‚æœæœ‰ç›¸å…³ä¿¡æ¯ï¼‰
3. æ“ä½œæ­¥éª¤ï¼ˆå¦‚ä½•è§¦å‘é”™è¯¯ï¼‰
4. ç³»ç»Ÿç‰ˆæœ¬ï¼ˆmacOS/Windows/Linuxï¼‰
